syntax = "proto3";

package aruna.api.v3;

import "models.proto";
import "google/protobuf/timestamp.proto";

service UserService {
    rpc RegisterUser(RegisterUserRequest) returns (RegisterUserResponse) {}
    rpc CreateToken(CreateTokenRequest) returns (CreateTokenResponse) {}
    rpc GetUser(GetUserRequest) returns (GetUserResponse) {}
    rpc DeleteToken(DeleteTokenRequest) returns (DeleteTokenResponse) {}
    rpc GetTokens(GetTokensRequest) returns (GetTokensResponse) {}
    rpc GetUserRealms(GetUserRealmsRequest) returns (GetUserRealmsResponse) {}
    rpc GetGroups(GetGroupsRequest) returns (GetGroupsResponse) {}

    // rpc UpdateUser(UpdateUserRequest) returns (UpdateUserResponse) {}
    // TODO: S3 credential requests ?
}

message RegisterUserRequest {
    string email = 1;
    string first_name = 2;
    string last_name = 3;
    string identifier = 4;
}

message RegisterUserResponse {
    aruna.api.v3.User user = 1;
}

message CreateTokenRequest {
    string name = 1;
    google.protobuf.Timestamp expires_at = 2;
    string resource_id = 3;
    aruna.api.v3.Permission permission = 4;
}

message CreateTokenResponse {
    aruna.api.v3.Token token = 1;
}

message GetUserRequest {
    string user_id = 1;
}

message GetUserResponse {
    aruna.api.v3.User user = 1;
}

message DeleteTokenRequest {
    string token_id = 1;
}

message DeleteTokenResponse {}

message GetTokensRequest {}

message GetTokensResponse {
    repeated aruna.api.v3.Token tokens = 1;
}

message GetUserRealmsRequest {}

message GetUserRealmsResponse {
    repeated string realms = 1;
}
message GetGroupsRequest {}
message GetGroupsResponse {
    repeated GroupWithPermission group_with_permission = 1; 
}

message GroupWithPermission {
    aruna.api.v3.Group group = 1;
    Permission permission = 2;
}
